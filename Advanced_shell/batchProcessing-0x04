#!/bin/bash

# List of Pokémon to retrieve
pokemon_list=("bulbasaur" "ivysaur" "venusaur" "charmander" "charmeleon")

# Function to fetch data
fetch_pokemon() {
  local name="$1"
  local retries=3
  local success=false

  for ((i=1; i<=retries; i++)); do
    echo "Fetching $name (Attempt $i)..."
    if curl -s -f -o "${name}.json" "https://pokeapi.co/api/v2/pokemon/${name}"; then
      echo "$name fetched successfully"
      success=true
      break
    else
      echo "Failed to fetch $name. Retrying..."
      sleep 2
    fi
  done

  if [ "$success" = false ]; then
    echo "$name failed after $retries attempts." >> error.log
  fi
}

# Loop through Pokémon list and fetch in parallel
for name in "${pokemon_list[@]}"; do
  fetch_pokemon "$name" &
done

# Wait for all background fetches to complete
wait

echo "✅ All fetch operations complete."
